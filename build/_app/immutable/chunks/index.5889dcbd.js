import{s as ae,f as Z,g as v,h as Y,d as I,j as M,i as F,v as re,X as oe,M as ce,B as G,Y as de,p as fe,l as ue,m as he,n as ge,Z as ye,e as Q,_ as me}from"./scheduler.a5e5241a.js";import{S as be,i as pe}from"./index.b1dbd351.js";const Ce=window;function x(t,s,i={}){const o=Object.assign({tab:"	",indentOn:/[({\[]$/,moveToNewLine:/^[)}\]]/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:Ce},i),a=o.window,u=a.document;let C=[],g=[],f=-1,k=!1,w,p;t.setAttribute("contenteditable","plaintext-only"),t.setAttribute("spellcheck",o.spellcheck?"true":"false"),t.style.outline="none",t.style.overflowWrap="break-word",t.style.overflowY="auto",t.style.whiteSpace="pre-wrap";let r=!1;s(t),t.contentEditable!=="plaintext-only"&&(r=!0),r&&t.setAttribute("contenteditable","true");const b=W(()=>{const e=L();s(t,e),_(e)},30);let T=!1;const E=e=>!z(e)&&!V(e)&&e.key!=="Meta"&&e.key!=="Control"&&e.key!=="Alt"&&!e.key.startsWith("Arrow"),P=W(e=>{E(e)&&(D(),T=!1)},300),O=(e,n)=>{C.push([e,n]),t.addEventListener(e,n)};O("keydown",e=>{e.defaultPrevented||(p=j(),o.preserveIdent?$(e):J(e),o.catchTab&&te(e),o.addClosing&&ee(e),o.history&&(ne(e),E(e)&&!T&&(D(),T=!0)),r&&!ie(e)&&_(L()))}),O("keyup",e=>{e.defaultPrevented||e.isComposing||(p!==j()&&b(),P(e),w&&w(j()))}),O("focus",e=>{k=!0}),O("blur",e=>{k=!1}),O("paste",e=>{D(),se(e),D(),w&&w(j())});function L(){const e=A(),n={start:0,end:0,dir:void 0};let{anchorNode:l,anchorOffset:d,focusNode:h,focusOffset:y}=e;if(!l||!h)throw"error1";if(l===t&&h===t)return n.start=d>0&&t.textContent?t.textContent.length:0,n.end=y>0&&t.textContent?t.textContent.length:0,n.dir=y>=d?"->":"<-",n;if(l.nodeType===Node.ELEMENT_NODE){const m=u.createTextNode("");l.insertBefore(m,l.childNodes[d]),l=m,d=0}if(h.nodeType===Node.ELEMENT_NODE){const m=u.createTextNode("");h.insertBefore(m,h.childNodes[y]),h=m,y=0}return q(t,m=>{if(m===l&&m===h)return n.start+=d,n.end+=y,n.dir=d<=y?"->":"<-","stop";if(m===l)if(n.start+=d,!n.dir)n.dir="->";else return"stop";else if(m===h)if(n.end+=y,!n.dir)n.dir="<-";else return"stop";m.nodeType===Node.TEXT_NODE&&(n.dir!="->"&&(n.start+=m.nodeValue.length),n.dir!="<-"&&(n.end+=m.nodeValue.length))}),t.normalize(),n}function _(e){const n=A();let l,d=0,h,y=0;if(e.dir||(e.dir="->"),e.start<0&&(e.start=0),e.end<0&&(e.end=0),e.dir=="<-"){const{start:N,end:H}=e;e.start=H,e.end=N}let m=0;q(t,N=>{if(N.nodeType!==Node.TEXT_NODE)return;const H=(N.nodeValue||"").length;if(m+H>e.start&&(l||(l=N,d=e.start-m),m+H>e.end))return h=N,y=e.end-m,"stop";m+=H}),l||(l=t,d=t.childNodes.length),h||(h=t,y=t.childNodes.length),e.dir=="<-"&&([l,d,h,y]=[h,y,l,d]),n.setBaseAndExtent(l,d,h,y)}function c(){const n=A().getRangeAt(0),l=u.createRange();return l.selectNodeContents(t),l.setEnd(n.startContainer,n.startOffset),l.toString()}function U(){const n=A().getRangeAt(0),l=u.createRange();return l.selectNodeContents(t),l.setStart(n.endContainer,n.endOffset),l.toString()}function $(e){if(e.key==="Enter"){const n=c(),l=U();let[d]=X(n),h=d;if(o.indentOn.test(n)&&(h+=o.tab),h.length>0?(S(e),e.stopPropagation(),R(`
`+h)):J(e),h!==d&&o.moveToNewLine.test(l)){const y=L();R(`
`+d),_(y)}}}function J(e){if(r&&e.key==="Enter")if(S(e),e.stopPropagation(),U()==""){R(`
 `);const n=L();n.start=--n.end,_(n)}else R(`
`)}function ee(e){const n=`([{'"`,l=`)]}'"`,d=U(),h=c(),y=h.substr(h.length-1)==="\\",m=d.substr(0,1);if(l.includes(e.key)&&!y&&m===e.key){const N=L();S(e),N.start=++N.end,_(N)}else if(n.includes(e.key)&&!y&&(`"'`.includes(e.key)||[""," ",`
`].includes(m))){S(e);const N=L(),H=N.start==N.end?"":A().toString(),le=e.key+H+l[n.indexOf(e.key)];R(le),N.start++,N.end++,_(N)}}function te(e){if(e.key==="Tab")if(S(e),e.shiftKey){const n=c();let[l,d]=X(n);if(l.length>0){const h=L(),y=Math.min(o.tab.length,l.length);_({start:d,end:d+y}),u.execCommand("delete"),h.start-=y,h.end-=y,_(h)}}else R(o.tab)}function ne(e){if(z(e)){S(e),f--;const n=g[f];n&&(t.innerHTML=n.html,_(n.pos)),f<0&&(f=0)}if(V(e)){S(e),f++;const n=g[f];n&&(t.innerHTML=n.html,_(n.pos)),f>=g.length&&f--}}function D(){if(!k)return;const e=t.innerHTML,n=L(),l=g[f];if(l&&l.html===e&&l.pos.start===n.start&&l.pos.end===n.end)return;f++,g[f]={html:e,pos:n},g.splice(f+1);const d=300;f>d&&(f=d,g.splice(0,1))}function se(e){S(e);const n=(e.originalEvent||e).clipboardData.getData("text/plain").replace(/\r/g,""),l=L();R(n),s(t),_({start:Math.min(l.start,l.end)+n.length,end:Math.min(l.start,l.end)+n.length,dir:"<-"})}function q(e,n){const l=[];e.firstChild&&l.push(e.firstChild);let d=l.pop();for(;d&&n(d)!=="stop";)d.nextSibling&&l.push(d.nextSibling),d.firstChild&&l.push(d.firstChild),d=l.pop()}function B(e){return e.metaKey||e.ctrlKey}function z(e){return B(e)&&!e.shiftKey&&K(e)==="Z"}function V(e){return B(e)&&e.shiftKey&&K(e)==="Z"}function ie(e){return B(e)&&K(e)==="C"}function K(e){let n=e.key||e.keyCode||e.which;if(n)return(typeof n=="string"?n:String.fromCharCode(n)).toUpperCase()}function R(e){e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),u.execCommand("insertHTML",!1,e)}function W(e,n){let l=0;return(...d)=>{clearTimeout(l),l=a.setTimeout(()=>e(...d),n)}}function X(e){let n=e.length-1;for(;n>=0&&e[n]!==`
`;)n--;n++;let l=n;for(;l<e.length&&/[ \t]/.test(e[l]);)l++;return[e.substring(n,l)||"",n,l]}function j(){return t.textContent||""}function S(e){e.preventDefault()}function A(){var e;return((e=t.parentNode)===null||e===void 0?void 0:e.nodeType)==Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.getSelection():a.getSelection()}return{updateOptions(e){Object.assign(o,e)},updateCode(e){t.textContent=e,s(t)},onUpdate(e){w=e},toString:j,save:L,restore:_,recordHistory:D,destroy(){for(let[e,n]of C)t.removeEventListener(e,n)}}}function we(t,s={}){const i=Object.assign({class:"codejar-linenumbers",wrapClass:"codejar-wrap",width:"35px",backgroundColor:"rgba(128, 128, 128, 0.15)",color:""},s);let o;return function(a){t(a),o||(o=Ne(a,i),a.addEventListener("scroll",()=>o.style.top=`-${a.scrollTop}px`));const C=(a.textContent||"").replace(/\n+$/,`
`).split(`
`).length+1;let g="";for(let f=1;f<C;f++)g+=`${f}
`;o.innerText=g}}function Ne(t,s){const i=getComputedStyle(t),o=document.createElement("div");o.className=s.wrapClass,o.style.position="relative";const a=document.createElement("div");a.className=s.class,o.appendChild(a),a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.bottom="0px",a.style.width=s.width,a.style.overflow="hidden",a.style.backgroundColor=s.backgroundColor,a.style.color=s.color||i.color,a.style.setProperty("mix-blend-mode","difference"),a.style.fontFamily=i.fontFamily,a.style.fontSize=i.fontSize,a.style.lineHeight=i.lineHeight,a.style.paddingTop=i.paddingTop,a.style.paddingLeft=i.paddingLeft,a.style.borderTopLeftRadius=i.borderTopLeftRadius,a.style.borderBottomLeftRadius=i.borderBottomLeftRadius;const u=document.createElement("div");return u.style.position="relative",u.style.top="0px",a.appendChild(u),t.style.paddingLeft=`calc(${s.width} + ${a.style.paddingLeft})`,t.style.whiteSpace="pre",t.parentNode.insertBefore(o,t),o.appendChild(t),u}function _e(t,s){let{highlight:i,onUpdate:o,syntax:a,value:u,withLineNumbers:C,...g}=s,f=x(t,p(i),g);function k(){f.destroy();const r=t.parentElement;if(r&&r.classList.contains("codejar-wrap")){const b=r.parentElement;t.style.padding="",b.appendChild(t),r.remove()}}function w(r){o&&o(f.toString())}function p(r){const b=r?T=>{var E;T.innerHTML=r((E=T.textContent)!==null&&E!==void 0?E:"",a)}:T=>{};return C?we(b):b}return t.addEventListener("input",w),{destroy(){k(),t.removeEventListener("input",w)},update(r){({highlight:i,onUpdate:o,syntax:a,value:u,withLineNumbers:C,...g}=r),s.highlight!==i||s.withLineNumbers!==C?(k(),f=x(t,p(i),s)):f.updateOptions(g),u!==f.toString()&&f.updateCode(u),s={highlight:i,value:u,withLineNumbers:C,...g}}}}function Te(t){let s;return{c(){s=ue(t[1])},l(i){s=he(i,t[1])},m(i,o){F(i,s,o)},p(i,o){o&2&&ge(s,i[1])},d(i){i&&I(s)}}}function ke(t){let s,i=t[12](t[1],t[13])+"",o;return{c(){s=new ye(!1),o=Q(),this.h()},l(a){s=me(a,!1),o=Q(),this.h()},h(){s.a=o},m(a,u){s.m(i,a,u),F(a,o,u)},p(a,u){u&12290&&i!==(i=a[12](a[1],a[13])+"")&&s.p(i)},d(a){a&&(I(o),s.d())}}}function Le(t){let s,i,o,a,u,C,g,f;function k(r,b){return r[12]?ke:Te}let w=k(t),p=w(t);return{c(){s=Z("pre"),i=Z("code"),p.c(),this.h()},l(r){s=v(r,"PRE",{class:!0,style:!0});var b=Y(s);i=v(b,"CODE",{class:!0});var T=Y(i);p.l(T),T.forEach(I),b.forEach(I),this.h()},h(){M(i,"class",o=t[13]?`language-${t[13]}`:""),M(s,"class",a=(t[13]?`language-${t[13]}`:"")+" "+(t[2]??"")),M(s,"style",u=t[3]?t[3]:"")},m(r,b){F(r,s,b),re(s,i),p.m(i,null),t[15](s),g||(f=oe(C=_e.call(null,s,{addClosing:t[4],catchTab:t[5],highlight:t[12],history:t[6],indentOn:t[7],onUpdate:t[14],preserveIdent:t[8],spellcheck:t[9],syntax:t[13],tab:t[10],value:t[1],withLineNumbers:t[11]})),g=!0)},p(r,[b]){w===(w=k(r))&&p?p.p(r,b):(p.d(1),p=w(r),p&&(p.c(),p.m(i,null))),b&8192&&o!==(o=r[13]?`language-${r[13]}`:"")&&M(i,"class",o),b&8196&&a!==(a=(r[13]?`language-${r[13]}`:"")+" "+(r[2]??""))&&M(s,"class",a),b&8&&u!==(u=r[3]?r[3]:"")&&M(s,"style",u),C&&ce(C.update)&&b&16370&&C.update.call(null,{addClosing:r[4],catchTab:r[5],highlight:r[12],history:r[6],indentOn:r[7],onUpdate:r[14],preserveIdent:r[8],spellcheck:r[9],syntax:r[13],tab:r[10],value:r[1],withLineNumbers:r[11]})},i:G,o:G,d(r){r&&I(s),p.d(),t[15](null),g=!1,f()}}}function Ee(t,s,i){const o=de();let{element:a=void 0}=s,{class:u=void 0}=s,{style:C=void 0}=s,{addClosing:g=!0}=s,{catchTab:f=!0}=s,{history:k=!0}=s,{indentOn:w=/{$/}=s,{preserveIdent:p=!0}=s,{spellcheck:r=!1}=s,{tab:b="	"}=s,{withLineNumbers:T=void 0}=s,{highlight:E=void 0}=s,{syntax:P=void 0}=s,{value:O=""}=s;function L(c){i(1,O=c),o("change",{value:c})}function _(c){fe[c?"unshift":"push"](()=>{a=c,i(0,a)})}return t.$$set=c=>{"element"in c&&i(0,a=c.element),"class"in c&&i(2,u=c.class),"style"in c&&i(3,C=c.style),"addClosing"in c&&i(4,g=c.addClosing),"catchTab"in c&&i(5,f=c.catchTab),"history"in c&&i(6,k=c.history),"indentOn"in c&&i(7,w=c.indentOn),"preserveIdent"in c&&i(8,p=c.preserveIdent),"spellcheck"in c&&i(9,r=c.spellcheck),"tab"in c&&i(10,b=c.tab),"withLineNumbers"in c&&i(11,T=c.withLineNumbers),"highlight"in c&&i(12,E=c.highlight),"syntax"in c&&i(13,P=c.syntax),"value"in c&&i(1,O=c.value)},[a,O,u,C,g,f,k,w,p,r,b,T,E,P,L,_]}class Oe extends be{constructor(s){super(),pe(this,s,Ee,Le,ae,{element:0,class:2,style:3,addClosing:4,catchTab:5,history:6,indentOn:7,preserveIdent:8,spellcheck:9,tab:10,withLineNumbers:11,highlight:12,syntax:13,value:1})}}const He=Oe;export{He as CodeJar};
